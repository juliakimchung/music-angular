var finished = require('tap-finished');
var parser = require('tap-parser');

var ZuulReporter = require('../zuul');

if (typeof global.console === 'undefined') {
    global.console = {};
}

var reporter = ZuulReporter(run);
var previous_test = undefined;
var assertions = 0;
var done = false;
var noMoreTests = false;

var parse_stream = parser();

var finished_stream = finished(function() {
    done = true;
    parse_stream.end();
    reporter.done();
});

var originalLog = global.console.log;
global.console